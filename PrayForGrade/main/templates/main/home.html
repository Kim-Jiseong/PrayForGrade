{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'home.css' %}" type="text/css"/>
<!-- <div class="yb"></div> -->
<div class="header">
    <div class="title">
        <p>
            2022년 1학기 학점 <br/>{{ postlist | length}} 과목 <br/>합동 분향소
        </p>
    </div>
</div>
<div class="container">



    {% for list in postlist %}

    <div class="postWrapper" >
        <a href="detail/{{list.pk}}">
            <div class="inner">{{list.subject}}</div>
            <div class="pic"><img src="{% static 'img/burner-apng.png' %}"></div>
        </a>
    </div>
    <div class="postWrapper">
        <a href="{% url 'detail' pk=list.pk %}">
            <div class="inner">{{list.subject}}</div>
            <div class="pic"><img src="{% static 'img/burner-apng.png' %}"></div>
        </a>
    </div>
    <div class="postWrapper">
        <a href="{{list.pk}}">
            <div class="inner">{{list.subject}}</div>
            <div class="pic"><img src="{% static 'img/burner-apng.png' %}"></div>
        </a>
    </div>

    <!-- <li>{{list.grade}}</li>
    <li>{{list.term}}</li> -->
    {% endfor %}

    <!-- 새로고침 방지 이걸로도 가능 onsubmit="return false;"  -->
</div>
<form  id="feed-create" method="post" class="createForm" enctype="multipart/form-data">
    {% csrf_token %}
    이름<br>
    <input class="username" id="username"type="text" name="username" required><br>
    과목명<br>
    <input class="subject"  id="subject"name="subject" required></input><br>
    학점<br>
    <!-- <input class="grade" name="grade"></input><br> -->
    <select name="grade" id="grade"class="grade" default="F" required>
        <option value="">학점을 선택하세요</option>
        <option value="B0">B0</option>
        <option value="B-">B-</option>
        <option value="C+">C+</option>
        <option value="C0">C0</option>
        <option value="C-">C-</option>
        <option value="D+">D+</option>
        <option value="D0">D0</option>
        <option value="D-">D-</option>
        <option value="F">F</option>
        <option value="NP">NP</option>
    </select>
    <!-- term<br> -->
    <input class="term" id="term" name="term" value="2022-1"></input><br>
    
    <input type="submit" value="조의를 표하기">
    <input onclick="closeModal()"type="button" value="닫기">
</form>
<!-- <a href="new_post/"> -->
    <!-- <div onclick="addClassName()" id="writeBtn" class="writeBtn">
        글쓰기
    </div> -->
<!-- </a> -->
<img id="writeBtn" class="writeBtn"src="{% static 'img/cover.png' %}" onclick="openModal()"/>
<img class="crying"src="{% static 'img/crying-gif.gif' %}"/>
<div class="yb"></div>
<script>


// 클래스 추가
function openModal() {
  document.getElementById('writeBtn').classList.add('modal');
  document.getElementById('feed-create').classList.add('createOpen');
}
function closeModal() {
  document.getElementById('writeBtn').classList.remove('modal');
  document.getElementById('feed-create').classList.remove('createOpen');
}

    // 피드 추가 부분
    $('#feed-create').submit((event) => {
//   event.preventDefault() 새로고침 방지
    var form = $("#feed-create")[0];
    var form_data = new FormData(form);
    username = $("#username").val();
    subject = $("#subject").val();
    grade = $("#grade").val();
    term = $("#term").val();

    form_data.append("username", username);
    form_data.append("subject", subject);
    form_data.append("grade", grade);
    form_data.append("term", term);
    $.ajax({
        type: "POST",
        enctype: 'multipart/form-data',
        url: 'new_post/',
        data: form_data,
        processData: false,
        contentType: false,

        // success: function (data) {
        //     console.log("success")
        // }, 
        // beforeSend: function () {
        //     console.log("beforesend")
        // },
        // complete: function () {
        //     console.log("complete")
        // },
        // error: function (e) {
        //     console.log("error", e);
        // }
    });
})
</script>
{% endblock %} 